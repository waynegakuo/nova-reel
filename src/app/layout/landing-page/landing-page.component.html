<section class="landing-container">
  <div class="header">
    <h1>Welcome to {{ title() }}</h1>
    <p class="subtitle">Discover the best movies and TV shows</p>
  </div>

  <div class="tabs">
    @for (tab of ['Movies', 'TV Shows', 'Favorites']; track $index) {
      <button
        class="btn-tab"
        [class.active]="activeTab() === tab"
        (click)="setActiveTab(tab)">
        {{ tab }}
      </button>
    }
  </div>

  <div class="content">
    <!-- Category selectors - always visible based on active tab -->
    @if (activeTab() === 'Movies') {
      <div class="category-selector">
        <button (click)="loadMovies('popular')" class="btn-category" [class.active]="activeMovieCategory() === 'popular'">Popular</button>
        <button (click)="loadMovies('top_rated')" class="btn-category" [class.active]="activeMovieCategory() === 'top_rated'">Top Rated</button>
        <button (click)="loadMovies('now_playing')" class="btn-category" [class.active]="activeMovieCategory() === 'now_playing'">Now Playing</button>
        <button (click)="loadMovies('upcoming')" class="btn-category" [class.active]="activeMovieCategory() === 'upcoming'">Upcoming</button>
      </div>
    } @else if (activeTab() === 'TV Shows') {
      <div class="category-selector">
        <button (click)="loadTVShows('popular')" class="btn-category" [class.active]="activeTVShowCategory() === 'popular'">Popular</button>
        <button (click)="loadTVShows('top_rated')" class="btn-category" [class.active]="activeTVShowCategory() === 'top_rated'">Top Rated</button>
        <button (click)="loadTVShows('on_the_air')" class="btn-category" [class.active]="activeTVShowCategory() === 'on_the_air'">On The Air</button>
        <button (click)="loadTVShows('airing_today')" class="btn-category" [class.active]="activeTVShowCategory() === 'airing_today'">Airing Today</button>
      </div>
    }

    <!-- Dynamic content area that refreshes -->
    <div class="dynamic-content">
      <!-- Loading indicator -->
      @if (isLoading()) {
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <p>Loading content...</p>
        </div>
      }

      <!-- Error message -->
      @if (error()) {
        <div class="error-container">
          <p>{{ error() }}</p>
          <button class="btn-primary" (click)="activeTab() === 'Movies' ? loadMovies('popular') : loadTVShows('popular')">
            Try Again
          </button>
        </div>
      }

      <!-- Movies tab content -->
      @if (activeTab() === 'Movies' && !isLoading() && !error()) {
        <div class="media-grid">
          @if (movies().length === 0 && !isLoading()) {
            <p>No movies found.</p>
          } @else {
            @for (movie of movies(); track movie.id) {
              <app-media-card
                [item]="movie"
                type="movie"
                (share)="onShareMedia($event)">
              </app-media-card>
            }
          }
        </div>

        <!-- Pagination controls for Movies -->
        <div class="pagination-controls">
          <button
            class="btn-pagination"
            [disabled]="currentMoviePage() <= 1"
            (click)="prevMoviePage()">
            Previous
          </button>

          @for (page of [1, 2, 3, 4, 5]; track page) {
            <button
              class="btn-pagination page-number"
              [class.active]="currentMoviePage() === page"
              (click)="goToMoviePage(page)">
              {{ page }}
            </button>
          }

          <button
            class="btn-pagination"
            [disabled]="currentMoviePage() >= MAX_PAGES"
            (click)="nextMoviePage()">
            Next
          </button>
        </div>
      }

      <!-- TV Shows tab content -->
      @if (activeTab() === 'TV Shows' && !isLoading() && !error()) {
        <div class="media-grid">
          @if (tvShows().length === 0 && !isLoading()) {
            <p>No TV shows found.</p>
          } @else {
            @for (tvShow of tvShows(); track tvShow.id) {
              <app-media-card
                [item]="tvShow"
                type="tvshow"
                (share)="onShareMedia($event)">
              </app-media-card>
            }
          }
        </div>

        <!-- Pagination controls for TV Shows -->
        <div class="pagination-controls">
          <button
            class="btn-pagination"
            [disabled]="currentTVShowPage() <= 1"
            (click)="prevTVShowPage()">
            Previous
          </button>

          @for (page of [1, 2, 3, 4, 5]; track page) {
            <button
              class="btn-pagination page-number"
              [class.active]="currentTVShowPage() === page"
              (click)="goToTVShowPage(page)">
              {{ page }}
            </button>
          }

          <button
            class="btn-pagination"
            [disabled]="currentTVShowPage() >= MAX_PAGES"
            (click)="nextTVShowPage()">
            Next
          </button>
        </div>
      }

      <!-- Favorites tab content -->
      @if (activeTab() === 'Favorites' && !isLoading() && !error()) {
        <div class="media-grid">
          @if (favorites().length === 0) {
            <div class="favorites-placeholder">
              <p>You haven't added any favorites yet</p>
            </div>
          } @else {
            @for (favorite of favorites(); track favorite.id) {
              <app-media-card
                [item]="favorite"
                [type]="favorite.mediaType"
                (share)="onShareMedia($event)">
              </app-media-card>
            }
          }
        </div>
      }
    </div>
  </div>
</section>
